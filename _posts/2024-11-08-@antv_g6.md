---
layout: post
title: G6
categories: [G6]
tags: [G6, 数据可视化]
---

``G6`` 简介：强分析、高性能、易扩展的图可视分析引擎。[蚂蚁数据可视化官网](https://antv-2018.alipay.com/zh-cn/index.html)、[G6官网](https://g6.antv.antgroup.com/)、[关于G6](https://antv-2018.alipay.com/zh-cn/g6/3.x/index.html)、[版本5示例](https://g6.antv.antgroup.com/examples)、[版本4示例](https://g6-v4.antv.vision/examples#net-dagreFlow)、[版本4简介](https://g6-v4.antv.vision/manual/introduction)




# G6
+ [流程图](#流程图)






## 流程图
[流程图配置项](https://g6-v4.antv.vision/api/graph-layout/dagre)

**demo**

![g6_01](/static/img/g6/g6_01.jpg)

```vue
{% raw %}
<template>
  <!-- 
    流程图 - 自由度高，节点之间配置连线即可，G6.TreeGraph 树图由于数据结构是树形的没法反向连线。
 -->
  <div ref="container" id="container"></div>
</template>

<script>
import G6 from "@antv/g6";
import dagreData from "./data.js";

export default {
  name: "demo",
  created() {
    // 自定义节点
    G6.registerNode("card-node", {
      draw: function drawShape(cfg, group) {
        const r = 2;
        const color = "#5B8FF9";
        // cfg 为 defaultNode 配置项配的引用 & 节点数据项的引用
        const w = cfg.size[0];
        const h = cfg.size[1];
        // addShap 方法的结果要作为方法的返回值使用
        const shape = group.addShape("rect", {
          name: "整体背景色块",
          attrs: {
            x: -w / 2,
            y: -h / 2,
            width: w,
            height: h,
            stroke: color,
            radius: r,
            fill: "#fff"
          }
        });
        group.addShape("rect", {
          name: "标题背景色块",
          attrs: {
            x: -w / 2,
            y: -h / 2,
            width: w,
            height: h / 2,
            fill: color,
            radius: [r, r, 0, 0]
          }
        });
        group.addShape("text", {
          name: "标题文本",
          attrs: {
            textBaseline: "top",
            x: -w / 2 + 8,
            y: -h / 2 + 2,
            lineHeight: 20,
            text: cfg.id,
            fill: "#fff"
          }
        });
        group.addShape("text", {
          name: "描述文本",
          attrs: {
            textBaseline: "top",
            x: -w / 2 + 8,
            y: -h / 2 + 24,
            lineHeight: 20,
            text: "description",
            fill: "rgba(0,0,0, 1)",
          }
        });

        return shape;
      }
    });

    // 自定义边
    G6.registerEdge("card-edge", {
      labelAutoRotate: true,
      draw(cfg, group) {
        const startPoint = cfg.startPoint;
        const endPoint = cfg.endPoint;
        // cfg 为 defaultEdge 配置项配的引用 & 边线数据项的引用
        const stroke = (cfg.style && cfg.style.stroke) || this.options.style.stroke;
        const shape = group.addShape("path", {
          name: "边线",
          attrs: {
            stroke,
            path: [
              ["M", startPoint.x, startPoint.y],
              ["L", endPoint.x, endPoint.y],
            ],
          }
        });
        
        // 边线文字
        group.addShape("text", {
          name: "边线文字",
          attrs: {
            text: cfg.label,
            fill: "#595959",
            textAlign: "center",
            textBaseline: "middle",
            x: startPoint.x,
            y: startPoint.y / 2
          }
        });

        return shape;
      },
    });
  },
  mounted() {
    const dagre = new G6.Graph({
      container: this.$refs.container, // id 或者 dom 元素
      width: 1840,
      height: 600,
      modes: {
        default: [
          "drag-canvas", // 拖动画布
          "zoom-canvas", // 缩放画布
        ],
      },
      layout: {
        type: "dagre", // 流程图
        begin: [0, 0], // 布局的左上角对齐位置
        rankdir: "TB", // 布局顺序 'TB' | 'BT' | 'LR' | 'RL'
        align: "UL", // 对齐方式 'UL' | 'UR' | 'DL' | 'DR' | undefined
        nodesep: 50, // 节点的水平或垂直（根据布局顺序而定）间距
        // nodesepFunc: function (n) {}, // nodesep 的回调函数
        ranksep: 10, // 层间距
        // ranksepFunc: function (n) {}, // ranksep 的回调函数
        controlPoints: false, // 是否保留布局连线的控制点
        workerEnabled: false, //  是否启用 web-worker 以防布局计算时间过长阻塞页面交互。 ⚠️ 注意: workerEnabled: true 时，不支持所有函数类型的参数。
        sortByCombo: false, // 同一层节点是否根据每个节点数据中的 comboId 进行排序，以防止 combo 重叠
        nodeOrder: undefined, // 同层节点顺序的参考数组，存放节点 id 值。若未指定，则将按照 dagre 本身机制排列同层节点顺序。
      },
      defaultNode: {
        type: "card-node", // 自定义节点类型（通过 G6.registerNode('card-node', {...})）进行注册（默认节点无需声明此属性）
        size: [80, 50], // 节点大小
        style: {
          stroke: '#c2c8d5'
        },
        anchorPoints: [
          // 节点的连线位置（可以设置多个，0、0.5、1 百分比浮点数，分别表示左、中、右，数组第一个之水平位置第二个之垂直位置）
          [0, 0.5], // 左边连线点
          [1, 0.5], // 右边连线点
        ],
      },
      defaultEdge: {
        type: "card-edge", // 自定义边类型（通过 G6.registerEdge('card-edge', {...})）进行注册（默认节点无需声明此属性）
        lineDash: [2, 2], // 虚线的间距和长度
        style: {
          // 线的样式
          stroke: 'orange'
        },
        labelCfg: {
          // 文字的样式
        },
      },
    });

    dagre.data(dagreData);
    dagre.render();

    // 节点定制化 - 根据条件设置节点的边距或者使用不同的自定义节点类型
    // dagre.node((node) => {
    //   return {};
    // });

    // 边定制化 - 根据条件设置边线的样式或者使用不同的自定义边线类型
    // darge.edge((edge) => {
    //   return {};
    // });

    // 事件绑定 - 画布渲染后触发
    // darge.on("afterrender", () => {
    //   darge.changeSize(500, 500) // 再次改变画布大小
    // });

    // 事件绑定 - 节点点击事件
    // darge.on("node-click", () => {});

    // 事件绑定 - 边点击事件
    // darge.on("edge-click", () => {});

    // api
    // fitView - 图形适应画布大小
    // moveTo - 移动图形到指定坐标
    // changeSize - 改变画布大小
    // getCanvasBBox - 获取图形大小
    // data - 设置数据
    // render - 渲染

    // 技巧
    // 隐藏节点 - 给节点配置 display: false 属性。
    // 隐藏边 - 通过边的定制化设置透明度。
  },
};
</script>

<style lang="less" scoped>
#container {
  height: 100%;
  width: 100%;
}
</style>
{% endraw %}
```
> 流程图 - 自由度高，节点之间配置连线即可，G6.TreeGraph 树图由于数据结构是树形的没法反向连线。